<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="image/favicon.png" rel="icon" />
  <title>Iniciar Sesión</title>
  <!-- CSS Parte Inicio -->
  <link rel="stylesheet" type="text/css" href="js/bootstrap/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.carousel.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.transitions.css" />
  <link rel="stylesheet" type="text/css" href="css/responsive.css" />
  <link rel="stylesheet" type="text/css" href="css/estilop.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans' type='text/css'>
  <!-- CSS Parte Fin -->
</head>

<body>
 
  <body class="amazon-style">
    <div class="wrapper-wide">
      <!-- Inicio del encabezado -->
      <header class="header">
        <div class="logo">
          <a href="index.html"><img class="img-responsive" src="image/logo.png" title="Click Store"
              alt="Click Store" /></a>
        </div>
        <div class="search-bar">
          <select>
            <option value="Todos">Todos</option>
            <option value="Electrónica">Electrónica</option>
            <option value="Informática">Informática</option>
            <option value="Ropa">Ropa</option>
            <option value="Automóviles">Automóviles</option>
            <option value="Belleza">Belleza</option>
            <!-- Agregar más opciones -->
          </select>
          <input id="filter_name" type="text" name="search" value="" placeholder="Buscar Producto" />
          <button type="button" class="button-search"><i class="fa fa-search"></i></button>
        </div>
        <div class="nav-links">
          <a href="login.html">Iniciar Sesión</a>
          <div class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user-plus"></i>Registro <b
                class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="registro-usu.html">Usuario</a></li>
              <li><a href="registro-comer.html">Comerciante</a></li>
            </ul>
          </div>
          <a href="wishlist.html"><i class="fa fa-heart"></i>Favoritos</a>
          <a href="cart.html"><i class="fa fa-shopping-cart"></i>Carrito</a>
        </div>
      </header>

      <!-- Menú Principal Fin -->
      <div id="container">
        <div class="container">
          <!-- Breadcrumb Start -->
          <ul class="breadcrumb">
            <li><a href="index.html"><i class="fa fa-home"></i></a></li>
            <li><a href="login.html">Cuenta</a></li>
            <li><a href="login.html">Iniciar Sesión</a></li>
          </ul>
          <!-- Breadcrumb End -->
          <div class="row">
            <!--Middle Part Start-->
            <div class="col-sm-9" id="content">
              <h1 class="title">Iniciar Sesión</h1>
              <p>Si ya tienes una cuenta con nosotros, por favor inicia sesión.</p>
              <form class="form-horizontal" action="javascript:void(0);" id="form-login">
                <fieldset id="account">
                  <legend>Detalles de tu cuenta</legend>
                  <div class="form-group required">
                    <label for="login-email" class="col-sm-2 control-label">E-Mail</label>
                    <div class="col-sm-10">
                      <input type="email" class="form-control" id="login-email" placeholder="E-Mail" name="email"
                        required>
                    </div>
                  </div>
                  <div class="form-group required">
                    <label for="login-password" class="col-sm-2 control-label">Contraseña</label>
                    <div class="col-sm-10">
                      <input type="password" class="form-control" id="login-password" placeholder="Contrasena"
                        name="contrasena" required>
                    </div>
                  </div>
                </fieldset>
                <div class="buttons">
                  <div class="pull-right">
                    <input type="submit" class="btn btn-primary" value="Iniciar Sesión">
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!--Footer Start-->
      <footer id="footer">
        <div class="fpart-first">
          <div class="container">
            <div class="row">
                             
                <!-- Pie de Página Inicio -->
    <footer id="footer">
      <p>&copy; 2024 Click Store | <a href="index.html">Inicio</a> | <a href="contact.html">Contacto</a></p>
    </footer>
    </div>


    

    <script>
      document.getElementById('form-login').addEventListener('submit', async function (event) {
        event.preventDefault();
    
        const email = document.getElementById('login-email').value;
        const contrasena = document.getElementById('login-password').value;
    
        const data = { email, contrasena };
    
        try {
          const response = await fetch('http://localhost:3000/api/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
          });
    
          if (response.ok) {
            const responseData = await response.json();
    
            // Guardar la información del usuario en sessionStorage
            sessionStorage.setItem('nombre', responseData.nombre); // Guarda el nombre del usuario
            sessionStorage.setItem('Id', responseData.Id);         // Guarda el ID del comerciante o usuario
            sessionStorage.setItem('tipo', responseData.tipo);     // "usuario" o "comerciante"
    
            // Verificar si el valor se guarda correctamente
            console.log("Datos guardados en sessionStorage:", sessionStorage.getItem('nombre'));
    
            // Redirigir según el tipo de usuario
            if (responseData.tipo === 'comerciante') {
              window.location.href = 'index-comer.html'; // Redirigir a la página del comerciante
            } else if (responseData.tipo === 'usuario') {
              window.location.href = 'index-usuario.html'; // Redirigir a la página del usuario
            }
          } else {
            const errorData = await response.json();
            alert('Error: ' + errorData.message);
          }
        } catch (error) {
          console.error('Error de conexión:', error);
        }
      });
    </script>
    
    
    <!-- JS Part Start-->
    <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/jquery.easing-1.3.min.js"></script>
    <script type="text/javascript" src="js/jquery.dcjqaccordion.min.js"></script>
    <script type="text/javascript" src="js/owl.carousel.min.js"></script>
    <script type="text/javascript" src="js/custom.js"></script>
    <script type="text/javascript" src="js/api.js"></script> <!-- Archivo JS -->
    <!-- JS Part End-->
  </body>

</html>