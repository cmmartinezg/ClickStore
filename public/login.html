







<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="image/favicon.png" rel="icon" />
  <title>Iniciar Sesión</title>
  
  <!-- CSS Parte Inicio -->
  <link rel="stylesheet" type="text/css" href="js/bootstrap/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.carousel.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.transitions.css" />
  <link rel="stylesheet" type="text/css" href="css/responsive.css" />
  <link rel="stylesheet" type="text/css" href="css/estilop.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans' type='text/css'>
  
  <!-- Toastr CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
  
  <!-- CSS Parte Fin -->
  
  <style>
    /* Custom styles for login form */
    body.amazon-style {
      background-color: #f0f2f5;
      font-family: 'Open Sans', sans-serif;
    }

    #container {
      padding: 40px 0;
    }

    .header {
      background-color: #fff;
      padding: 15px 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .header .logo img {
      max-height: 60px;
    }

    .header .search-bar {
      display: flex;
      align-items: center;
      margin-top: 10px;
    }

    .header .search-bar select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px 0 0 5px;
      outline: none;
      font-size: 16px;
      width: 200px;
    }

    .header .search-bar input[type="text"] {
      flex: 1;
      padding: 8px;
      border: 1px solid #ccc;
      border-left: none;
      outline: none;
      font-size: 16px;
    }

    .header .search-bar .button-search {
      padding: 8px 15px;
      background-color: #28a745;
      border: none;
      color: #fff;
      cursor: pointer;
      border-radius: 0 5px 5px 0;
      font-size: 18px;
      transition: background-color 0.3s;
    }

    .header .search-bar .button-search:hover {
      background-color: #218838;
    }

    .header .nav-links {
      margin-top: 10px;
      display: flex;
      align-items: center;
    }

    .header .nav-links a {
      margin-left: 15px;
      font-size: 16px;
      color: #333;
      transition: color 0.3s;
    }

    .header .nav-links a:hover {
      color: #28a745;
    }

    .breadcrumb {
      background: none;
      padding-left: 0;
      margin-bottom: 20px;
      list-style: none;
    }

    .breadcrumb li {
      display: inline;
      margin-right: 10px;
    }

    .breadcrumb li a {
      color: #00244a;
      text-decoration: none;
      font-size: 16px;
    }

    .breadcrumb li a:hover {
      text-decoration: underline;
    }

    .form-horizontal {
      max-width: 500px;
      margin: 0 auto;
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .form-horizontal legend {
      font-size: 24px;
      margin-bottom: 20px;
      text-align: center;
      color: #333;
    }

    .form-group label {
      font-size: 18px;
      color: #555;
    }

    .form-control {
      font-size: 16px;
      padding: 10px;
    }

    .buttons .btn {
      width: 100%;
      padding: 12px;
      font-size: 18px;
      border-radius: 5px;
    }

    .btn-primary {
      background-color: #28a745;
      border-color: #28a745;
      transition: background-color 0.3s, border-color 0.3s;
    }

    .btn-primary:hover {
      background-color: #218838;
      border-color: #1e7e34;
    }

    footer#footer {
      background-color: #343a40;
      color: #fff;
      padding: 20px 0;
      text-align: center;
      margin-top: 40px;
    }

    footer#footer a {
      color: #28a745;
      text-decoration: none;
      margin: 0 10px;
    }

    footer#footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body class="amazon-style">
  <div class="wrapper-wide">
    <!-- Inicio del encabezado -->
    <header class="header">
      <div class="logo">
        <a href="index.html"><img class="img-responsive" src="image/logo.png" title="Click Store" alt="Click Store" /></a>
      </div>
     
      <div class="nav-links">
        <a href="login.html">Iniciar Sesión</a>
        <div class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user-plus"></i>Registro <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="registro-usu.html">Usuario</a></li>
            <li><a href="registro-comer.html">Comerciante</a></li>
          </ul>
        </div>
        <a href="wishlist.html"><i class="fa fa-heart"></i>Favoritos</a>
        <a href="cart.html"><i class="fa fa-shopping-cart"></i>Carrito</a>
      </div>
    </header>
    <!-- Menú Principal Fin -->

    <div id="container">
      <div class="container">
        <!-- Breadcrumb Start -->
        <ul class="breadcrumb">
          <li><a href="index.html"><i class="fa fa-home"></i></a></li>
          <li><a href="login.html">Cuenta</a></li>
          <li><a href="login.html">Iniciar Sesión</a></li>
        </ul>
        <!-- Breadcrumb End -->

        <div class="row">
          <!--Middle Part Start-->
          <div class="col-sm-9" id="content">
            <h1 class="title">Iniciar Sesión</h1>
            <p class="welcome-text">Si ya tienes una cuenta con nosotros, por favor inicia sesión.</p>
       <form class="form-horizontal" action="javascript:void(0);" id="form-login">
              <fieldset id="account">
                <legend>Detalles de tu cuenta</legend>
                <div class="form-group required">
                  <label for="login-email" class="col-sm-2 control-label">E-Mail</label>
                  <div class="col-sm-10">
                    <input type="email" class="form-control" id="login-email" placeholder="E-Mail" name="email" required>
                  </div>
                </div>
                <div class="form-group required">
                  <label for="login-password" class="col-sm-2 control-label">Contraseña</label>
                  <div class="col-sm-10">
                    <input type="password" class="form-control" id="login-password" placeholder="Contraseña" name="contrasena" required>
                  </div>
                </div>
              </fieldset>
              <div class="buttons">
                <div class="pull-right">
                  <input type="submit" class="btn btn-primary" value="Iniciar Sesión">
                </div>
              </div>
            </form>
          </div>
          <!--Middle Part End-->
        </div>
      </div>
    </div>

    <!--Footer Start-->
    <footer id="footer">
      <p>&copy; 2024 Click Store | <a href="index.html">Inicio</a> | <a href="contact.html">Contacto</a></p>
    </footer>
    <!--Footer End-->
  </div>

  <!-- Toastr JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  
  <!-- JS Part Start-->
  <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="js/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/jquery.easing-1.3.min.js"></script>
  <script type="text/javascript" src="js/jquery.dcjqaccordion.min.js"></script>
  <script type="text/javascript" src="js/owl.carousel.min.js"></script>
  <script type="text/javascript" src="js/custom.js"></script>
  <script type="text/javascript" src="js/api.js"></script> <!-- Archivo JS -->
  <!-- JS Part End-->

  <script>
    // Configuración de Toastr
    toastr.options = {
      "closeButton": true,
      "debug": false,
      "newestOnTop": false,
      "progressBar": true,
      "positionClass": "toast-top-right",
      "preventDuplicates": false,
      "onclick": null,
      "showDuration": "300",
      "hideDuration": "1000",
      "timeOut": "5000",
      "extendedTimeOut": "1000",
      "showEasing": "swing",
      "hideEasing": "linear",
      "showMethod": "fadeIn",
      "hideMethod": "fadeOut"
    }

    document.getElementById('form-login').addEventListener('submit', async function (event) {
  event.preventDefault();
  
  const email = document.getElementById('login-email').value;
  const contrasena = document.getElementById('login-password').value;
  
  const data = { email, contrasena };

  try {
    const response = await fetch('http://localhost:3000/api/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    if (!response.ok) {
      const errorData = await response.json();
      alert('Error: ' + errorData.message);
      return;
    }

    const responseData = await response.json();
    
    // Guardar la información del usuario en sessionStorage
    sessionStorage.setItem('nombre', responseData.nombre); // Guarda el nombre del usuario
    sessionStorage.setItem('Id', responseData.Id);         // Guarda el ID del comerciante o usuario
    sessionStorage.setItem('tipo', responseData.tipo);     // "usuario" o "comerciante"
    
    // Redirigir según el tipo de usuario
    if (responseData.tipo === 'comerciante') {
      window.location.href = 'index-comer.html'; // Redirigir a la página del comerciante
    } else if (responseData.tipo === 'usuario') {
      window.location.href = 'index-usuario.html'; // Redirigir a la página del usuario
    }

  } catch (error) {
    console.error('Error de conexión o problema con la API:', error);
    alert('Ocurrió un error al intentar iniciar sesión. Por favor, intenta nuevamente.');
  }
});

</script>

</body>

</html>
