







<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="image/favicon.png" rel="icon" />
  <title>Iniciar Sesión</title>
  
  <!-- CSS Parte Inicio -->
  <link rel="stylesheet" type="text/css" href="js/bootstrap/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.carousel.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.transitions.css" />
  <link rel="stylesheet" type="text/css" href="css/responsive.css" />
  <link rel="stylesheet" type="text/css" href="css/estilop.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans' type='text/css'>
  <!-- Toastr CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">

  <style>
/* Contenedor principal centrado */
.container {
    max-width: 500px;
    margin: 5% auto;
    padding: 40px;
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.1);
    text-align: center;
}

#account {
    margin-top: 10px;
    
}

#account legend {
    font-size: 15px;
    font-weight: 300;
    text-align: left;
    margin-bottom: 10px;
    color: #333;
}

/* Logo dentro del contenedor */
.logo-container {
    text-align: left;
    margin-bottom: 10px;
}

.logo {
    width: 100px;
    height: auto;
}
/* Estilo del título */
.title {
    font-size: 25px;
    text-align: center;
    font-weight: bold;
    margin-bottom: 20px;
}

/* Estilo de los campos de entrada */
.form-control {
    width: 100%;
    border-radius: 30px;
    padding: 15px 20px;
    font-size: 16px;
    border: 1px solid #ddd;
    margin-bottom: 15px;
}

/* Alineación de etiquetas e inputs */
.form-horizontal .form-group {
    display: flex;
    flex-direction: column;
    margin-bottom: 15px;
    text-align: left;
}

.form-horizontal label {
    font-weight: bold;
    margin-bottom: 5px;
    color: #333;
    font-size: 14px;
}

/* Enlace de "Olvidaste tu contraseña" */
.forgot-password {
    text-align: right;
    margin-top: -10px;
    margin-bottom: 15px;
}

.forgot-password a {
    text-decoration: none;
    color: #fa8072;
    font-size: 14px;
}

.forgot-password a:hover {
    text-decoration: underline;
}

/* Botón de inicio de sesión */
.btn-primary {
    background-color: #fa8072;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 30px;
    font-size: 18px;
    cursor: pointer;
    width: 100%;
    transition: background-color 0.3s ease;
}

.btn-primary:hover {
    background-color: #e06450;
}
/* Campos del formulario */
.form-group {
    margin-bottom: 20px;
    text-align: left;
}

.input-container {
    position: relative;
    display: flex;
    align-items: center;
}

.form-control {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 30px;
    outline: none;
    transition: all 0.3s ease;
}

.form-control:focus {
    border-color: #ffa500;
}

/* Icono de ojo para mostrar/ocultar contraseña */
.toggle-password {
    position:absolute;
    right: 15px;
    top: 25%;
    cursor: pointer;
    color: #aaa;
}

.toggle-password:hover {
    color: #ffa500;
}
  </style>
</head>

<body>
  <div class="container">
    <div class="logo-container">
        <img src="image/logo.png" alt="Click Store" class="logo">
    </div>

    <!-- <form class="form-horizontal" action="javascript:void(0);" id="form-login">
        <h1 class="title">Iniciar Sesión</h1>

            <div class="form-group">
                <label for="login-email">Correo electrónico</label>
                <div class="input-container">
                    <input type="email" class="form-control" id="login-email" placeholder="Correo electrónico" name="email" required>
                </div>
            </div>

            <div class="form-group">
                <label for="login-password">Contraseña</label>
                <div class="input-container">
                    <input type="password" class="form-control" id="login-password" placeholder="Contraseña" name="contrasena" required>
                    <i class="fa fa-eye toggle-password"></i>
                </div>
            </div>

        <div class="forgot-password">
            <a href="recuperar-contra.html">¿Olvidaste tu contraseña?</a>
        </div>

        <div class="buttons">
            <input type="submit" class="btn btn-primary" value="Continuar">
        </div>
    </form>
</div> -->
<form id="form-login">
    <label for="login-email">Email:</label>
    <input type="email" id="login-email" required>
    
    <label for="login-password">Contraseña:</label>
    <input type="password" id="login-password" required>
    
    <button type="submit">Iniciar Sesión</button>
</form>
<!-- <footer>
    <p>&copy; 2024 Click Store. Todos los derechos reservados | <a href="#">Términos y Condiciones</a></p>
</footer>
 -->

 
  
  <!-- JS Part Start-->
  <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="js/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/jquery.easing-1.3.min.js"></script>
  <script type="text/javascript" src="js/jquery.dcjqaccordion.min.js"></script>
  <script type="text/javascript" src="js/owl.carousel.min.js"></script>
  <script type="text/javascript" src="js/custom.js"></script>
  <script type="text/javascript" src="js/api.js"></script> <!-- Archivo JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

  <script> 


document.getElementById('form-login').addEventListener('submit', async function (event) {
            event.preventDefault();

            const email = document.getElementById('login-email').value;
            const contrasena = document.getElementById('login-password').value;
            const data = { email, contrasena };

            try {
                const response = await fetch('http://localhost:3000/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Error al iniciar sesión:', errorData);
                    alert('Error: ' + errorData.message);
                    return;
                }

                const responseData = await response.json();
                console.log("Datos de respuesta del servidor:", responseData);

                // Guardar usuarioId en localStorage y verificar que se guarde correctamente
                if (responseData.Id) {
                    localStorage.setItem('usuarioId', responseData.Id);
                    console.log("usuarioId almacenado en localStorage:", localStorage.getItem('usuarioId'));
                } else {
                    console.error("Id no encontrado en la respuesta del servidor.");
                    alert("Error: Id de usuario no encontrado en la respuesta.");
                    return;
                }

                // Redirigir según el tipo de usuario
                if (responseData.tipo === 'usuario') {
                    alert('Login exitoso como usuario. Redirigiendo...');
                    window.location.href = 'index-usuario.html';
                } else if (responseData.tipo === 'comerciante') {
                    alert('Login exitoso como comerciante. Redirigiendo...');
                    window.location.href = 'index-comer.html';
                }

            } catch (error) {
                console.error('Error de conexión o problema con la API:', error);
                alert('Ocurrió un error al intentar iniciar sesión. Por favor, intenta nuevamente.');
            }
        });
        
        // Mostrar u ocultar la contraseña
        const togglePassword = document.querySelector('.toggle-password');
        const passwordField = document.querySelector('#login-password');
        
        if (togglePassword) {
            togglePassword.addEventListener('click', () => {
                const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordField.setAttribute('type', type);
                togglePassword.classList.toggle('fa-eye-slash');
            });
        }
    </script>
    

</body>
</html>
