







<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="image/favicon.png" rel="icon" />
  <title>Iniciar Sesión</title>
  
  <!-- CSS Parte Inicio -->
  <link rel="stylesheet" type="text/css" href="js/bootstrap/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.carousel.css" />
  <link rel="stylesheet" type="text/css" href="css/owl.transitions.css" />
  <link rel="stylesheet" type="text/css" href="css/responsive.css" />
  <link rel="stylesheet" type="text/css" href="css/estilop.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans' type='text/css'>
  
  <!-- Toastr CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
  
  <!-- CSS Parte Fin -->
  
  <style>
/* Contenedor principal centrado */
.container {
    max-width: 400px;
    margin: 5% auto;
    padding: 40px;
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.1);
    text-align: center;
}

#account {
    margin-top: 10px;
    
}

#account legend {
    font-size: 15px;
    font-weight: 300;
    text-align: left;
    margin-bottom: 10px;
    color: #333;
}

/* Logo dentro del contenedor */
.logo-container {
    text-align: left;
    margin-bottom: 10px;
}

.logo {
    width: 100px;
    height: auto;
}
/* Estilo del título */
.title {
    font-size: 25px;
    text-align: center;
    font-weight: bold;
    margin-bottom: 20px;
}

/* Estilo de los campos de entrada */
.form-control {
    width: 100%;
    border-radius: 30px;
    padding: 15px 20px;
    font-size: 16px;
    border: 1px solid #ddd;
    margin-bottom: 15px;
}

/* Alineación de etiquetas e inputs */
.form-horizontal .form-group {
    display: flex;
    flex-direction: column;
    margin-bottom: 15px;
    text-align: left;
}

.form-horizontal label {
    font-weight: bold;
    margin-bottom: 5px;
    color: #333;
    font-size: 14px;
}

/* Enlace de "Olvidaste tu contraseña" */
.forgot-password {
    text-align: right;
    margin-top: -10px;
    margin-bottom: 15px;
}

.forgot-password a {
    text-decoration: none;
    color: #fa8072;
    font-size: 14px;
}

.forgot-password a:hover {
    text-decoration: underline;
}

/* Botón de inicio de sesión */
.btn-primary {
    background-color: #fa8072;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 30px;
    font-size: 18px;
    cursor: pointer;
    width: 100%;
    transition: background-color 0.3s ease;
}

.btn-primary:hover {
    background-color: #e06450;
}

/* Ajuste del pie de página */
/* footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    background-color: #000000;
    color: rgb(255, 255, 255);
    text-align: center;
    padding: 10px;
} */
  </style>
</head>

<body>
  <div class="container">
    <div class="logo-container">
        <img src="image/logo.png" alt="Click Store" class="logo">
    </div>

    <form class="form-horizontal" action="javascript:void(0);" id="form-login">
        <h1 class="title">Iniciar Sesión</h1>

        <fieldset id="account">
            <legend>Detalles de tu cuenta</legend>

            <div class="form-group required">
                <label for="login-email">E-Mail</label>
                <input type="email" class="form-control" id="login-email" placeholder="E-Mail" name="email" required>
            </div>

            <div class="form-group required">
                <label for="login-password">Contraseña</label>
                <input type="password" class="form-control" id="login-password" placeholder="Contraseña" name="contrasena" required>
            </div>
        </fieldset>

        <div class="forgot-password">
            <a href="recuperar-contra.html">¿Olvidaste tu contraseña?</a>
        </div>

        <div class="buttons">
            <input type="submit" class="btn btn-primary" value="Continuar">
        </div>
    </form>
</div>

<!-- <footer>
    <p>&copy; 2024 Click Store. Todos los derechos reservados | <a href="#">Términos y Condiciones</a></p>
</footer>
 -->

 

  <!-- Toastr JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  
  <!-- JS Part Start-->
  <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="js/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/jquery.easing-1.3.min.js"></script>
  <script type="text/javascript" src="js/jquery.dcjqaccordion.min.js"></script>
  <script type="text/javascript" src="js/owl.carousel.min.js"></script>
  <script type="text/javascript" src="js/custom.js"></script>
  <script type="text/javascript" src="js/api.js"></script> <!-- Archivo JS -->
  <!-- JS Part End-->

  <script>
    // Configuración de Toastr
    toastr.options = {
      "closeButton": true,
      "debug": false,
      "newestOnTop": false,
      "progressBar": true,
      "positionClass": "toast-top-right",
      "preventDuplicates": false,
      "onclick": null,
      "showDuration": "300",
      "hideDuration": "1000",
      "timeOut": "5000",
      "extendedTimeOut": "1000",
      "showEasing": "swing",
      "hideEasing": "linear",
      "showMethod": "fadeIn",
      "hideMethod": "fadeOut"
    }

    document.getElementById('form-login').addEventListener('submit', async function (event) {
  event.preventDefault();
  
  const email = document.getElementById('login-email').value;
  const contrasena = document.getElementById('login-password').value;
  
  const data = { email, contrasena };

  try {
    const response = await fetch('http://localhost:3000/api/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    if (!response.ok) {
      const errorData = await response.json();
      alert('Error: ' + errorData.message);
      return;
    }

    const responseData = await response.json();
    
    // Guardar la información del usuario en sessionStorage
    sessionStorage.setItem('nombre', responseData.nombre); // Guarda el nombre del usuario
    sessionStorage.setItem('Id', responseData.Id);         // Guarda el ID del comerciante o usuario
    sessionStorage.setItem('tipo', responseData.tipo);     // "usuario" o "comerciante"
    
    // Redirigir según el tipo de usuario
    if (responseData.tipo === 'comerciante') {
      window.location.href = 'index-comer.html'; // Redirigir a la página del comerciante
    } else if (responseData.tipo === 'usuario') {
      window.location.href = 'index-usuario.html'; // Redirigir a la página del usuario
    }

  } catch (error) {
    console.error('Error de conexión o problema con la API:', error);
    alert('Ocurrió un error al intentar iniciar sesión. Por favor, intenta nuevamente.');
  }
});
</script>
</body>
</html>
